"use strict";(self["webpackChunkcell"]=self["webpackChunkcell"]||[]).push([[585],{8316:function(e,t){t["Z"]={data(){return{slugField:""}},computed:{slugedGenre(){if(this.slugField){let e=this.slugField.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^0-9-a-zа-я\u0370-\u03ff\u1f00-\u1fff]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"");return e.replace(/\u0401/g,"YO").replace(/\u0419/g,"I").replace(/\u0426/g,"TS").replace(/\u0423/g,"U").replace(/\u041A/g,"K").replace(/\u0415/g,"E").replace(/\u041D/g,"N").replace(/\u0413/g,"G").replace(/\u0428/g,"SH").replace(/\u0429/g,"SCH").replace(/\u0417/g,"Z").replace(/\u0425/g,"H").replace(/\u042A/g,"").replace(/\u0451/g,"yo").replace(/\u0439/g,"i").replace(/\u0446/g,"ts").replace(/\u0443/g,"u").replace(/\u043A/g,"k").replace(/\u0435/g,"e").replace(/\u043D/g,"n").replace(/\u0433/g,"g").replace(/\u0448/g,"sh").replace(/\u0449/g,"sch").replace(/\u0437/g,"z").replace(/\u0445/g,"h").replace(/\u044A/g,"'").replace(/\u0424/g,"F").replace(/\u042B/g,"I").replace(/\u0412/g,"V").replace(/\u0410/g,"a").replace(/\u041F/g,"P").replace(/\u0420/g,"R").replace(/\u041E/g,"O").replace(/\u041B/g,"L").replace(/\u0414/g,"D").replace(/\u0416/g,"ZH").replace(/\u042D/g,"E").replace(/\u0444/g,"f").replace(/\u044B/g,"i").replace(/\u0432/g,"v").replace(/\u0430/g,"a").replace(/\u043F/g,"p").replace(/\u0440/g,"r").replace(/\u043E/g,"o").replace(/\u043B/g,"l").replace(/\u0434/g,"d").replace(/\u0436/g,"zh").replace(/\u044D/g,"e").replace(/\u042F/g,"Ya").replace(/\u0427/g,"CH").replace(/\u0421/g,"S").replace(/\u041C/g,"M").replace(/\u0418/g,"I").replace(/\u0422/g,"T").replace(/\u042C/g,"'").replace(/\u0411/g,"B").replace(/\u042E/g,"YU").replace(/\u044F/g,"ya").replace(/\u0447/g,"ch").replace(/\u0441/g,"s").replace(/\u043C/g,"m").replace(/\u0438/g,"i").replace(/\u0442/g,"t").replace(/\u044C/g,"'").replace(/\u0431/g,"b").replace(/\u044E/g,"yu")}return" "}}}},8319:function(e,t){t["Z"]={data(){return{Toast:this.$swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",this.$swal.stopTimer),e.addEventListener("mouseleave",this.$swal.resumeTimer)}})}},methods:{setSuccess(e){this.Toast.fire({icon:"success",title:e})},setError(){this.Toast.fire({icon:"error",title:"Произошла ошибка"})}}}},3453:function(e,t,r){r.d(t,{Z:function(){return p}});var l=r(3396);const a={class:"form-wrapper"},s=(0,l.Uk)("Создать");function i(e,t,r,i,u,o){const n=(0,l.up)("default-button"),m=(0,l.up)("Close"),c=(0,l.up)("Form");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(c,{class:"form","validation-schema":o.LocalSchema,onSubmit:o.onSubmit,ref:"Form"},{default:(0,l.w5)((()=>[(0,l._)("div",a,[(0,l.WI)(e.$slots,"default",{},void 0,!0)]),(0,l.Wm)(n,null,{default:(0,l.w5)((()=>[s])),_:1}),(0,l.Wm)(m,{class:"form-close",onClick:o.hideForm},null,8,["onClick"])])),_:3},8,["validation-schema","onSubmit"])])}var u=r(5708),o=r(9938),n=r(8810),m={name:"adminForm",emits:["hide","refForm","formValues"],components:{Close:n.Z,DefaultButton:o.Z,Form:u.l0,Field:u.gN,ErrorMessage:u.Bc},props:{schema:{type:Object},updateValues:{type:Object}},data(){return{setValues:null}},mounted(){this.$emit("refForm",this.$refs.Form)},methods:{onSubmit(e,{resetForm:t}){this.$emit("formValues",e),t()},hideForm(){this.$emit("hide",!1)}},computed:{LocalSchema(){return this.schema}}},c=r(89);const d=(0,c.Z)(m,[["render",i],["__scopeId","data-v-3d02cfa1"]]);var p=d},5781:function(e,t,r){r.d(t,{Z:function(){return k}});var l=r(3396),a=r(7139),s=r(9242);const i={class:"table-actions"},u={class:"table"},o={class:"table-header"},n={class:"table-body"},m={class:"table-body-item"},c={class:"table-body-item"},d={class:"table-body-item"};function p(e,t,r,p,g,f){const h=(0,l.up)("Pen"),b=(0,l.up)("Close");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",i,[(0,l._)("input",{type:"text",class:"input",onInput:t[0]||(t[0]=(...e)=>f.filterValue&&f.filterValue(...e))},null,32),(0,l._)("button",{class:"button",onClick:t[1]||(t[1]=(...e)=>f.visibleForm&&f.visibleForm(...e))},"Добавить запись")]),(0,l._)("div",u,[(0,l._)("div",o,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.tableHeader,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"table-header-item",key:Math.random()},(0,a.zw)(e),1)))),128))]),(0,l.wy)((0,l._)("div",n,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.data,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"table-row",key:e.id},[(0,l._)("div",m,(0,a.zw)(e.name),1),(0,l._)("div",c,(0,a.zw)(e.slug),1),(0,l._)("div",d,[(0,l.Wm)(h,{onClick:t=>f.updateValues(e.id)},null,8,["onClick"]),(0,l.Wm)(b,{onClick:t=>f.DeleteGenre(e.id)},null,8,["onClick"])])])))),128))],512),[[s.F8,r.data]])])],64)}const g={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48",width:"48px",height:"48px"},f=(0,l.uE)('<g id="surface209380960"><path style="stroke:none;fill-rule:nonzero;fill:rgb(89.803922%, 45.09804%, 45.09804%);fill-opacity:1;" d="M 42.582031 9.066406 L 38.933594 5.417969 C 38.378906 4.859375 37.472656 4.859375 36.917969 5.417969 L 35.199219 7.136719 L 40.863281 12.800781 L 42.582031 11.082031 C 43.140625 10.527344 43.140625 9.625 42.582031 9.066406 "></path><path style="stroke:none;fill-rule:nonzero;fill:rgb(100%, 59.607846%, 0%);fill-opacity:1;" d="M 38.03125 15.632812 L 12.570312 41.09375 L 6.90625 35.429688 L 32.367188 9.96875 Z M 38.03125 15.632812 "></path><path style="stroke:none;fill-rule:nonzero;fill:rgb(69.01961%, 74.509805%, 77.254903%);fill-opacity:1;" d="M 32.363281 9.96875 L 35.195312 7.132812 L 40.863281 12.796875 L 38.03125 15.632812 Z M 32.363281 9.96875 "></path><path style="stroke:none;fill-rule:nonzero;fill:rgb(100%, 75.686276%, 2.745098%);fill-opacity:1;" d="M 6.90625 35.429688 L 5 43 L 12.570312 41.09375 Z M 6.90625 35.429688 "></path><path style="stroke:none;fill-rule:nonzero;fill:rgb(21.568628%, 27.843139%, 30.980393%);fill-opacity:1;" d="M 5.964844 39.171875 L 5 43 L 8.828125 42.035156 Z M 5.964844 39.171875 "></path></g>',1),h=[f];function b(e,t,r,a,s,i){return(0,l.wg)(),(0,l.iD)("svg",g,h)}var v={name:"pen"},F=r(89);const y=(0,F.Z)(v,[["render",b]]);var _=y,w=r(8810),V={name:"Table",components:{Pen:_,Close:w.Z},emits:["visible","updateValues","DeleteItem","filterValue"],data(){return{}},props:{tableHeader:{type:Array},data:{type:Array}},mounted(){},methods:{filterValue(e){this.$emit("filterValue",e.currentTarget.value)},updateValues(e){this.$emit("updateValues",e),this.visibleForm()},visibleForm(){this.$emit("visible",!0)},DeleteGenre(e){this.$emit("DeleteItem",e)}}};const D=(0,F.Z)(V,[["render",p],["__scopeId","data-v-5f12cd1f"]]);var k=D},8810:function(e,t,r){r.d(t,{Z:function(){return d}});var l=r(3396);const a={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"48px",height:"48px"},s=(0,l._)("path",{fill:"#F44336",d:"M21.5 4.5H26.501V43.5H21.5z",transform:"rotate(45.001 24 24)"},null,-1),i=(0,l._)("path",{fill:"#F44336",d:"M21.5 4.5H26.5V43.501H21.5z",transform:"rotate(135.008 24 24)"},null,-1),u=[s,i];function o(e,t,r,s,i,o){return(0,l.wg)(),(0,l.iD)("svg",a,u)}var n={name:"close"},m=r(89);const c=(0,m.Z)(n,[["render",o]]);var d=c},5585:function(e,t,r){r.r(t),r.d(t,{default:function(){return O}});var l=r(3396),a=r(9242);const s={for:"name",class:"form-item"},i=(0,l.Uk)(" Введите название "),u={for:"slug",class:"form-item"},o=(0,l.Uk)(" Чпу "),n={for:"country",class:"form-item"},m=(0,l.Uk)(" Страна "),c={for:"duration",class:"form-item"},d=(0,l.Uk)(" Продолжительность "),p={for:"year",class:"form-item"},g=(0,l.Uk)(" Год "),f={for:"video",class:"form-item"},h=(0,l.Uk)(" Ссылка на видео "),b={for:"poster",class:"form-item"},v=(0,l.Uk)(" Постер "),F={for:"BigPoster",class:"form-item"},y=(0,l.Uk)(" Большой постер "),_={key:0,class:"form-item posters"},w={href:"#"},V=(0,l.Uk)(" Постер "),D=["src"],k={href:"#"},Z=(0,l.Uk)(" Большой постер "),I=["src"],U={for:"text",class:"form-item textarea"},W=(0,l.Uk)(" Описание ");function C(e,t,r,C,x,S){const L=(0,l.up)("Field"),T=(0,l.up)("ErrorMessage"),H=(0,l.up)("Select"),B=(0,l.up)("adminForm"),M=(0,l.up)("Table");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.wy)((0,l.Wm)(B,{onFormValues:S.submitData,schema:S.schema,onHide:S.visibleForm,onRefForm:S.refFormAction},{default:(0,l.w5)((()=>[(0,l._)("label",s,[i,(0,l.Wm)(L,{name:"name",id:"name",class:"input",modelValue:e.slugField,"onUpdate:modelValue":t[0]||(t[0]=t=>e.slugField=t),modelModifiers:{trim:!0}},null,8,["modelValue"]),(0,l.Wm)(T,{name:"name"})]),(0,l._)("label",u,[o,(0,l.Wm)(L,{name:"slug",id:"slug",class:"input slug",modelValue:e.slugedGenre,"onUpdate:modelValue":t[1]||(t[1]=t=>e.slugedGenre=t),readonly:!0},null,8,["modelValue"]),(0,l.Wm)(T,{name:"slug"})]),(0,l.Wm)(H,{id:"genres",label:"Жанры",name:"genres",options:e.genres},null,8,["options"]),(0,l.Wm)(H,{id:"actors",label:"Актеры",name:"actors",options:e.actors},null,8,["options"]),(0,l._)("label",n,[m,(0,l.Wm)(L,{name:"country",id:"country",class:"input"}),(0,l.Wm)(T,{name:"country"})]),(0,l._)("label",c,[d,(0,l.Wm)(L,{name:"duration",id:"duration",class:"input"}),(0,l.Wm)(T,{name:"duration"})]),(0,l._)("label",p,[g,(0,l.Wm)(L,{name:"year",id:"year",class:"input"}),(0,l.Wm)(T,{name:"year"})]),(0,l._)("label",f,[h,(0,l.Wm)(L,{name:"video",id:"video",class:"input"}),(0,l.Wm)(T,{name:"video"})]),(0,l._)("label",b,[v,(0,l.Wm)(L,{name:"poster",id:"poster",class:"input",type:"file"}),(0,l.Wm)(T,{name:"poster"})]),(0,l._)("label",F,[y,(0,l.Wm)(L,{name:"BigPoster",id:"BigPoster",class:"input",type:"file"}),(0,l.Wm)(T,{name:"poster"})]),x.currentUpdItem.poster?((0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("a",w,[V,(0,l._)("img",{src:x.currentUpdItem.poster,alt:""},null,8,D)]),(0,l._)("a",k,[Z,(0,l._)("img",{src:x.currentUpdItem.BigPoster,alt:""},null,8,I)])])):(0,l.kq)("",!0),(0,l._)("label",U,[W,(0,l.Wm)(L,{name:"text",id:"text",type:"text-area"},{default:(0,l.w5)((({field:e})=>[(0,l._)("textarea",(0,l.dG)({class:"input"},e),null,16)])),_:1}),(0,l.Wm)(T,{name:"text"})])])),_:1},8,["onFormValues","schema","onHide","onRefForm"]),[[a.F8,x.visible]]),(0,l.Wm)(M,{"table-header":x.tableHeader,data:e.searchTable,onUpdateValues:S.SetId,onVisible:S.visibleForm,onDeleteItem:S.DeleteItem,onFilterValue:S.setQuery},null,8,["table-header","data","onUpdateValues","onVisible","onDeleteItem","onFilterValue"])],64)}r(6699);var x=r(5781),S=r(3453),L=r(9938),T=r(5708),H=r(8316),B=r(8319),M=r(65),q=r(6542),E=r(4870),$={__name:"select",props:{values:{type:Array},name:{type:String,required:!0},label:{type:String,required:!0},options:{type:Array,required:!0}},setup(e){const t=e;let{errorMessage:r,value:a}=(0,T.U$)((0,E.Vh)(t,"name"));return(t,s)=>{const i=(0,l.up)("q-select");return(0,l.wg)(),(0,l.j4)(i,{class:"form-item field",multiple:"",options:e.options.map((e=>e.name)),label:e.label,modelValue:(0,E.SU)(a),"onUpdate:modelValue":s[0]||(s[0]=e=>(0,E.dq)(a)?a.value=e:a=e),"emit-value":"","error-message":(0,E.SU)(r),error:!!(0,E.SU)(r)},null,8,["options","label","modelValue","error-message","error"])}}},z=r(89);const A=(0,z.Z)($,[["__scopeId","data-v-d68029a6"]]);var P=A,G={name:"admin-films",mixins:[H.Z,B.Z],components:{Table:x.Z,AdminNav:x.Z,adminForm:S.Z,DefaultButton:L.Z,Field:T.gN,ErrorMessage:T.Bc,Select:P},data(){return{visible:!1,tableHeader:["Название","Чпу","действия"],updateId:null,submitType:"submit",refForm:null,poster:null,currentUpdItem:[],searchValue:null}},methods:{visibleForm(e){this.visible=e,!1===e&&(this.submitType="submit")},submitData(e){if("submit"===this.submitType){let t=this.genres.filter((t=>e.genres.includes(t.name)));t.forEach((e=>delete e.genre)),delete e.genres;let r={to:"films",val:e,genres:t};this.CreateItem(r).then((e=>this.setSuccess("Запись добавлена"))).catch((e=>this.setError()))}else if("update"===this.submitType){let t={id:this.updateId,to:"films",items:e};this.updateDoc(t).then((e=>this.setSuccess("Запись обновлена"))).catch((e=>this.setError())),this.submitType="submit"}this.currentUpdItem=[]},DeleteItem(e){let t={to:"films",id:e};this.DeleteDoc(t).then((e=>this.setSuccess("Запись удалена"))).catch((e=>this.setError())),this.currentUpdItem=[]},...(0,M.nv)({CreateItem:"admin/CreateItem",FetchData:"admin/FetchData",updateDoc:"admin/updateDoc",DeleteDoc:"admin/DeleteDoc"}),...(0,M.OI)({setFilmQuery:"admin/setFilmQuery"}),SetId(e){this.updateId=e},setQuery(e){this.setFilmQuery(e)},refFormAction(e){this.refForm=e}},mounted(){this.FetchData("films"),this.FetchData("genres"),this.FetchData("actors")},watch:{updateId(e){let t=this.films.find((t=>t.id===e));this.slugField=t.name,this.refForm.setFieldValue("text",t.text),this.refForm.setFieldValue("country",t.country),this.refForm.setFieldValue("duration",t.duration),this.refForm.setFieldValue("year",t.year),this.refForm.setFieldValue("video",t.video),this.refForm.setFieldValue("genres",t.genres.map((e=>e.name))),this.refForm.setFieldValue("actors",t.actors),this.submitType="update",this.currentUpdItem=t}},computed:{...(0,M.Se)({searchTable:"admin/searchTableFilms"}),...(0,M.rn)({films:e=>e.admin.films,genres:e=>e.admin.genres,actors:e=>e.admin.actors}),schema(){return q.Ry({name:q.Z_().required(),slug:q.Z_().required(),text:q.Z_().required(),country:q.Z_().required(),duration:q.Z_().required(),year:q.Z_().required(),video:q.Z_().required(),poster:q.Z_().required(),BigPoster:q.Z_().required(),genres:q.IX().min(1,"Необходимо выбрать хотябы 1 жанр").required(),actors:q.IX().min(1,"Необходимо выбрать хотябы 1 актера").required()})}}};const Y=(0,z.Z)(G,[["render",C],["__scopeId","data-v-03d354be"]]);var O=Y}}]);
//# sourceMappingURL=585.1430d812.js.map